#include <dt-bindings/leds/common.h>
#include <dt-bindings/usb/pd.h>
#include "sm7125-xiaomi-joyeuse.dts"
#include "sm7125-xiaomi-joyeuse-display.dts"
#include "sm7125-xiaomi-joyeuse-touch.dts"
#include "sm7125-xiaomi-joyeuse-camera.dts"

&soc {
        sound: sound { };
};

#include "sm7125-xiaomi-joyeuse-sound.dts"

/* must add sc7180 into compatible machine or add cpu blocklist with sm7125 */
/ {
	compatible = "xiaomi,joyeuse", "db845c", "qcom,sm7125", "qcom,sc7180";

	battery: battery {
		compatible = "simple-battery";

		voltage-min-design-microvolt = <3400000>;
		voltage-max-design-microvolt = <4400000>;

		charge-full-design-microamp-hours = <5160000>;

		constant-charge-current-max-microamp = <1800000>;
	};
};

/* that can protect ufs partition untouch */
&ufs_mem_hc {
	status = "disabled";
};

&ufs_mem_phy {
	status = "disabled";
};

&pm6150_qgauge {
	status = "okay";
};

&pm6150_rtc {
	status = "okay";
};

&pm6150_charger {
	monitored-battery = <&battery>;
	status = "disabled";
};

&pm6150_typec {
	vdd-vbus-supply = <&pm6150_vbus>;
	vdd-pdphy-supply = <&vreg_l17a_3p1>;
	status = "okay";

	connector {
		compatible = "usb-c-connector";

		vbus-supply = <&pm6150_vbus>;

		power-role = "sink";
		data-role = "device";
		pd-disable;
		self-powered;

		typec-power-opmode = "default";

		try-power-role = "sink";

		source-pdos = <PDO_FIXED(5000, 3000, PDO_FIXED_DUAL_ROLE |
				PDO_FIXED_USB_COMM | PDO_FIXED_DATA_SWAP)>;

		ports {
			#address-cells = <1>;
			#size-cells = <0>;

			port@0 {
				reg = <0>;
				pm6150_role_switch_in: endpoint {
					remote-endpoint = <&usb_1_dwc3_hs>;
				};
			};
		};
	};
};

&pm6150_vbus {
	regulator-min-microamp = <500000>;
	regulator-max-microamp = <3000000>;
	status = "okay";
};

&pm6150_typec {
	vdd-vbus-supply = <&pm6150_vbus>;
	vdd-pdphy-supply = <&vph_pwr>;	
	status = "okay";
};

&qupv3_id_0 {
	status = "okay";
};

&qupv3_id_1 {
	status = "okay";
};

&pm6150_qgauge {
        monitored-battery = <&battery>;
        status = "okay";
};

&touchscreen {
//	status = "disabled";
};

&remoteproc_mpss {
	status = "okay";
};

&pm6150l_lpg {
        status = "okay";

	led@1 {
		reg = <1>;
		color = <LED_COLOR_ID_WHITE>;
		function = LED_FUNCTION_STATUS;
	};
};

&usb_1_dwc3 {
	vbus-supply = <&pm6150_vbus>;

	ports {
		#address-cells = <1>;
		#size-cells = <0>;
	
		port@0 {
				reg = <0>;
	
				usb_1_dwc3_hs: endpoint {
				};
		};
	
		port@1 {
				reg = <1>;
	
				usb_1_dwc3_ss: endpoint {
				};
		};
	};
};

/* disable it atm as it stuck the icc driver when fw not ready */
&venus {
	status = "disabled";
};
